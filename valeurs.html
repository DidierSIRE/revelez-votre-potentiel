<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Valeurs & Motivations – classement 6→1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --orange:#FFA726; --vert:#2E7D32; --fond:#f7f9fa; --txt:#222; --card:#fff;
      --gris:#ccc; --gris-txt:#666; --shadow:0 2px 10px rgba(0,0,0,.1);
      --hdrH:120px;
    }
    *{ box-sizing:border-box }
    body{ font-family:'Segoe UI',sans-serif; background:var(--fond); color:var(--txt); margin:0; }

    /* Header fixe (même style que les autres pages) */
    .site-header{position:fixed; top:0; left:0; right:0; z-index:1000; background:var(--orange); color:#fff; box-shadow:0 2px 10px rgba(0,0,0,.15)}
    .title-row{display:flex; align-items:center; justify-content:center; gap:16px; padding:16px 12px 6px}
    .branch{width:120px; height:auto; opacity:.95; filter:drop-shadow(0 2px 2px rgba(0,0,0,.12))}
    .branch.mirror{transform:scaleX(-1)}
    .site-title{margin:0; font-size:clamp(1.6rem,2.8vw,2.3rem)}
    .nav{display:flex; gap:14px; justify-content:center; flex-wrap:wrap; background:rgba(255,255,255,.12); padding:8px 12px 12px; border-top:1px solid rgba(255,255,255,.12)}
    .nav a{color:#fff; text-decoration:none; padding:8px 12px; border-radius:8px; font-weight:600}
    .nav a:hover{background:rgba(255,255,255,.18)}
    .page-offset{height:calc(var(--hdrH) + 18px)}

    /* Page */
    .wrap{ max-width:980px; margin:auto; padding:1.25rem 1.25rem 2rem; }
    h1{ color:var(--vert); text-align:center; margin:.2rem 0 .3rem; }
    p.lead{ text-align:center; color:#444; margin:0 0 1.2rem; }

    .card{ background:var(--card); border-radius:12px; box-shadow:var(--shadow); padding:1.2rem; }
    .topbar{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:1rem; flex-wrap:wrap; }
    .progress{ flex:1; height:10px; background:#eee; border-radius:999px; overflow:hidden; }
    .progress > span{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#FFA726,#2E7D32); transition:width .3s; }
    .step{ font-weight:600; color:#333; min-width:110px; text-align:right; }

    h2.q{ margin:.2rem 0 .8rem; font-size:1.15rem; color:#1f4b2c; }
    .hint{ font-size:.92rem; color:#555; margin:.1rem 0 1rem; }

    /* Tableau des options */
    .opt{ display:grid; grid-template-columns: 1fr auto; align-items:center;
          gap:.8rem; background:#fff; border-radius:12px; border:1px solid #eee;
          padding:.6rem .8rem; margin:.55rem 0; }

    /* Réglette */
    .strip{ display:flex; align-items:center; gap:.6rem; background:#fff;
            border:2px solid var(--orange); border-radius:9999px; padding:.35rem .6rem; }
    .dot{ width:28px; height:28px; border-radius:50%; border:2px solid var(--orange);
          display:flex; align-items:center; justify-content:center; cursor:pointer;
          user-select:none; font-size:.9rem; color:var(--orange); background:#fff;
          transition:transform .07s ease; }
    .dot:hover{ transform:scale(1.06); }
    .dot.selected{ background:var(--orange); color:#fff; }

    .btnbar{ display:flex; gap:10px; justify-content:center; margin-top:1.2rem; flex-wrap:wrap; }
    .btn{ border:none; padding:.85rem 1.15rem; border-radius:10px; font-weight:700; cursor:pointer; }
    .btn-orange{ background:var(--orange); color:#fff; box-shadow:0 6px 14px rgba(255,167,38,.35); }
    .btn-orange:disabled{ background:#ccc; color:#666; box-shadow:none; cursor:not-allowed; }
    .btn-ghost{ background:#f1f1f1; color:#333; }

    .done{ text-align:center; padding:2rem 1rem; }
    .done p{ margin:.35rem 0 .9rem; }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="title-row">
      <img class="branch" src="branche.png" alt="Branche d’olivier">
      <h1 class="site-title">Révélez votre potentiel</h1>
      <img class="branch mirror" src="branche.png" alt="Branche d’olivier (miroir)">
    </div>
    <nav class="nav" aria-label="Navigation principale">
      <a href="index.html">Accueil</a>
      <a href="test.html">Test gratuit</a>
      <a href="prestations.html">Prestations</a>
      <a href="exemples.html">Exemples</a>
      <a href="contact.html">Contact</a>
    </nav>
  </header>
  <div class="page-offset"></div>

  <div class="wrap">
    <h1>Évaluation Valeurs & Motivations</h1>
    <p class="lead">Pour chaque situation, classez les 6 propositions de <strong>6 (la plus importante)</strong> à <strong>1 (la moins importante)</strong>, via la réglette ovale. Chaque rang ne peut être utilisé <em>qu’une seule fois</em>.</p>

    <div class="card" id="card">
      <div class="topbar">
        <div class="progress"><span id="bar"></span></div>
        <div class="step" id="step">1 / 30</div>
      </div>

      <h2 class="q" id="question">Question…</h2>
      <p class="hint">Cliquez sur un chiffre (6→1) pour l’assigner à la proposition. Si ce rang est déjà pris sur une autre ligne, il sera déplacé ici.</p>

      <div id="options"></div>

      <div class="btnbar">
        <button class="btn btn-ghost" id="reset">Réinitialiser ce classement</button>
        <button class="btn btn-orange" id="next" disabled>Valider ce classement</button>
      </div>
    </div>

    <div class="card done" id="done" style="display:none;">
      <h2>Merci !</h2>
      <p>Vos réponses « Valeurs &amp; Motivations » ont été enregistrées.</p>
      <p>Vous recevrez un <strong>rapport croisé DISC &amp; Valeurs</strong> sous 24&nbsp;h.</p>
      <button class="btn btn-orange" onclick="window.location.href='index.html'">Retour à l’accueil</button>
    </div>
  </div>

  <script>
    // === Noms des 6 valeurs
    const V = {
      TRAD:'Traditionnalisme – Religion',
      COG:'Cognitif – Théorie – Savoir',
      ESTH:'Esthétisme – Art – Spiritualité',
      POL:'Individualisme – Politique',
      ECON:'Matérialisme – Économique – Utilitaire',
      SOC:'Altruisme – Social'
    };

    // === Items (30 questions, 6 propositions chacune) ===
    const items = [
      { q:"Vous commencez un nouveau projet professionnel. Qu’est-ce qui vous motive le plus ?",
        opts:[
          {t:"Aligner le projet avec vos valeurs", k:"TRAD"},
          {t:"Comprendre les mécanismes du projet", k:"COG"},
          {t:"Créer un environnement agréable", k:"ESTH"},
          {t:"Diriger l’équipe et influencer le projet", k:"POL"},
          {t:"Gagner une prime ou un bonus", k:"ECON"},
          {t:"Travailler avec des collègues bienveillants", k:"SOC"},
        ]},
      { q:"Vous avez une journée libre. Comment préférez-vous l’occuper ?",
        opts:[
          {t:"Lire un ouvrage spécialisé", k:"COG"},
          {t:"Méditer ou réfléchir à votre place dans le monde", k:"TRAD"},
          {t:"Organiser une activité pour un groupe", k:"POL"},
          {t:"Passer du temps avec vos proches", k:"SOC"},
          {t:"Trouver un moyen de générer des revenus passifs", k:"ECON"},
          {t:"Visiter un musée ou créer quelque chose", k:"ESTH"},
        ]},
      { q:"Une entreprise vous propose un poste attractif. Qu’est-ce qui retient le plus votre attention ?",
        opts:[
          {t:"L’esprit d’équipe et l’entraide", k:"SOC"},
          {t:"L’impact éthique ou moral du travail", k:"TRAD"},
          {t:"Le design et l’ambiance du lieu de travail", k:"ESTH"},
          {t:"Le potentiel d’apprentissage", k:"COG"},
          {t:"Le salaire et les avantages", k:"ECON"},
          {t:"Les responsabilités stratégiques", k:"POL"},
        ]},
      { q:"Vous devez choisir un livre à lire ce mois-ci. Lequel prenez-vous ?",
        opts:[
          {t:"Un essai scientifique ou philosophique", k:"COG"},
          {t:"Un guide sur la réussite financière", k:"ECON"},
          {t:"Un roman poétique ou esthétique", k:"ESTH"},
          {t:"Un texte spirituel ou religieux", k:"TRAD"},
          {t:"Une biographie d’un leader charismatique", k:"POL"},
          {t:"Une histoire sur l’amitié ou l’altruisme", k:"SOC"},
        ]},
      { q:"Lors d’un conflit d’équipe, que privilégiez-vous ?",
        opts:[
          {t:"Analyser les faits pour mieux comprendre", k:"COG"},
          {t:"Évaluer les conséquences économiques", k:"ECON"},
          {t:"Favoriser l’écoute et la solidarité", k:"SOC"},
          {t:"Imposer une décision pour avancer", k:"POL"},
          {t:"Rechercher l’harmonie et apaiser l’ambiance", k:"ESTH"},
          {t:"Trouver un sens profond à ce conflit", k:"TRAD"},
        ]},
      { q:"On vous propose d’intervenir lors d’une conférence. Quelle motivation prédomine ?",
        opts:[
          {t:"Asseoir votre crédibilité et votre autorité", k:"POL"},
          {t:"Attirer des opportunités professionnelles", k:"ECON"},
          {t:"Créer une présentation visuellement marquante", k:"ESTH"},
          {t:"Inspirer ou aider les autres participants", k:"SOC"},
          {t:"Partager des connaissances rigoureuses", k:"COG"},
          {t:"Transmettre un message porteur de sens", k:"TRAD"},
        ]},
      { q:"Une réussite personnelle vous rend heureux. Laquelle ?",
        opts:[
          {t:"Avoir aidé une personne dans le besoin", k:"SOC"},
          {t:"Avoir compris un concept complexe", k:"COG"},
          {t:"Avoir économisé ou gagné une grosse somme", k:"ECON"},
          {t:"Avoir été reconnu comme un leader", k:"POL"},
          {t:"Avoir réalisé un projet artistique", k:"ESTH"},
          {t:"Avoir respecté vos convictions profondes", k:"TRAD"},
        ]},
      { q:"Dans un groupe de travail, quel rôle préférez-vous ?",
        opts:[
          {t:"Chef de projet ou coordinateur", k:"POL"},
          {t:"Chercheur ou analyste", k:"COG"},
          {t:"Créateur ou designer", k:"ESTH"},
          {t:"Gestionnaire des ressources", k:"ECON"},
          {t:"Médiateur ou soutien moral", k:"SOC"},
          {t:"Référent éthique ou porteur de sens", k:"TRAD"},
        ]},
      { q:"Si vous deviez lancer une entreprise, votre priorité serait :",
        opts:[
          {t:"Avoir un impact humain positif", k:"SOC"},
          {t:"Créer un branding unique et inspirant", k:"ESTH"},
          {t:"Influencer le marché ou le secteur", k:"POL"},
          {t:"Innover à partir de données fiables", k:"COG"},
          {t:"Rentabiliser rapidement l’activité", k:"ECON"},
          {t:"Respecter une mission alignée avec vos valeurs", k:"TRAD"},
        ]},
      { q:"Quelle activité vous épanouirait le plus ?",
        opts:[
          {t:"Créer une œuvre ou aménager un espace", k:"ESTH"},
          {t:"Investir intelligemment", k:"ECON"},
          {t:"Mener un projet d’envergure", k:"POL"},
          {t:"Participer à une retraite spirituelle", k:"TRAD"},
          {t:"Résoudre un problème complexe", k:"COG"},
          {t:"Soutenir une cause ou des personnes", k:"SOC"},
        ]},
      { q:"Dans un poste idéal, qu’aimeriez-vous faire au quotidien ?",
        opts:[
          {t:"Accompagner vos collègues", k:"SOC"},
          {t:"Donner du sens au travail de l’équipe", k:"TRAD"},
          {t:"Imaginer des solutions originales", k:"ESTH"},
          {t:"Optimiser les dépenses", k:"ECON"},
          {t:"Prendre des décisions importantes", k:"POL"},
          {t:"Résoudre des problématiques intellectuelles", k:"COG"},
        ]},
      { q:"Quel aspect d’un voyage vous attire le plus ?",
        opts:[
          {t:"Admirer les paysages et l’architecture", k:"ESTH"},
          {t:"Découvrir une culture ou une histoire", k:"COG"},
          {t:"Gérer le voyage de manière rentable", k:"ECON"},
          {t:"Organiser tout le programme", k:"POL"},
          {t:"Rencontrer les habitants", k:"SOC"},
          {t:"Vivre une expérience de transformation personnelle", k:"TRAD"},
        ]},
      { q:"Vous êtes confronté à un échec. Comment réagissez-vous ?",
        opts:[
          {t:"Vous analysez les causes avec rigueur", k:"COG"},
          {t:"Vous calculez la perte et cherchez à la compenser", k:"ECON"},
          {t:"Vous cherchez à exprimer vos émotions autrement", k:"ESTH"},
          {t:"Vous cherchez la signification profonde de cette épreuve", k:"TRAD"},
          {t:"Vous essayez de reprendre le contrôle de la situation", k:"POL"},
          {t:"Vous vous entourez de soutien", k:"SOC"},
        ]},
      { q:"Une discussion vous passionne lorsqu’elle parle de :",
        opts:[
          {t:"Arts, création, beauté", k:"ESTH"},
          {t:"Business, performance, finance", k:"ECON"},
          {t:"Empathie, entraide, relations humaines", k:"SOC"},
          {t:"Morale, conscience, existence", k:"TRAD"},
          {t:"Pouvoir, influence, leadership", k:"POL"},
          {t:"Théories, concepts, sciences", k:"COG"},
        ]},
      { q:"Vous devez organiser un événement. Vous vous concentrez surtout sur :",
        opts:[
          {t:"L’accueil des invités", k:"SOC"},
          {t:"L’ambiance visuelle et sensorielle", k:"ESTH"},
          {t:"L’efficacité logistique", k:"POL"},
          {t:"La structure du contenu", k:"COG"},
          {t:"La symbolique ou l’intention de l’événement", k:"TRAD"},
          {t:"Le budget et les coûts", k:"ECON"},
        ]},
      { q:"Quand vous pensez à votre futur, vous vous projetez surtout dans :",
        opts:[
          {t:"L’évolution de vos connaissances", k:"COG"},
          {t:"Un cadre de vie inspirant", k:"ESTH"},
          {t:"Une position stratégique", k:"POL"},
          {t:"Une quête de sens ou de foi", k:"TRAD"},
          {t:"Une vie entourée de gens bienveillants", k:"SOC"},
          {t:"Votre sécurité financière", k:"ECON"},
        ]},
      { q:"À quoi reconnaît-on une journée réussie ?",
        opts:[
          {t:"Vous avez aidé quelqu’un", k:"SOC"},
          {t:"Vous avez appris quelque chose de nouveau", k:"COG"},
          {t:"Vous avez eu de l’impact dans un projet", k:"POL"},
          {t:"Vous avez fait une bonne affaire", k:"ECON"},
          {t:"Vous avez vécu un moment esthétique ou artistique", k:"ESTH"},
          {t:"Vous vous êtes senti(e) aligné(e) intérieurement", k:"TRAD"},
        ]},
      { q:"Une cause vous touche profondément si elle :",
        opts:[
          {t:"Défend l’éducation et la recherche", k:"COG"},
          {t:"Défend la liberté d’expression", k:"POL"},
          {t:"Protège les personnes vulnérables", k:"SOC"},
          {t:"Soutient la spiritualité ou la foi", k:"TRAD"},
          {t:"Valorise la culture et la création", k:"ESTH"},
          {t:"Améliore les conditions économiques", k:"ECON"},
        ]},
      { q:"Ce que vous admirez chez une personne, c’est surtout :",
        opts:[
          {t:"Sa capacité d’analyse", k:"COG"},
          {t:"Sa compassion", k:"SOC"},
          {t:"Sa sagesse intérieure", k:"TRAD"},
          {t:"Son charisme et sa capacité à diriger", k:"POL"},
          {t:"Son goût et sa sensibilité artistique", k:"ESTH"},
          {t:"Son sens des affaires", k:"ECON"},
        ]},
      { q:"Vous êtes en équipe. On vous demande votre avis. Vous…",
        opts:[
          {t:"Calculez les bénéfices possibles", k:"ECON"},
          {t:"Orientez vers une stratégie claire", k:"POL"},
          {t:"Présentez des données précises", k:"COG"},
          {t:"Proposez une idée originale", k:"ESTH"},
          {t:"Rappelez les valeurs fondamentales du projet", k:"TRAD"},
          {t:"Tenez compte de l’humain avant tout", k:"SOC"},
        ]},
      { q:"Vous recevez un budget pour un projet. Que faites-vous ?",
        opts:[
          {t:"Affectez les ressources selon la stratégie choisie", k:"POL"},
          {t:"Dépensez de façon stratégique pour maximiser le retour", k:"ECON"},
          {t:"Étudiez les meilleures pratiques et données", k:"COG"},
          {t:"Investissez dans le bien-être des personnes impliquées", k:"SOC"},
          {t:"Mettez en valeur l’esthétique du projet", k:"ESTH"},
          {t:"Veillez à ce que les dépenses soient alignées avec vos principes", k:"TRAD"},
        ]},
      { q:"Vous êtes dans une conversation de groupe. Vous êtes le plus à l’aise quand :",
        opts:[
          {t:"On débat d’idées", k:"COG"},
          {t:"On échange des astuces pour réussir", k:"ECON"},
          {t:"On évoque des questions existentielles", k:"TRAD"},
          {t:"On parle d’art ou de design", k:"ESTH"},
          {t:"On parle d’influence ou de vision", k:"POL"},
          {t:"On partage des expériences humaines", k:"SOC"},
        ]},
      { q:"Vous êtes invité à rejoindre un projet bénévole. Vous acceptez si :",
        opts:[
          {t:"Il a une dimension éducative ou intellectuelle", k:"COG"},
          {t:"Il aide directement des personnes en difficulté", k:"SOC"},
          {t:"Il défend une cause qui vous touche intérieurement", k:"TRAD"},
          {t:"Il permet une gestion efficace des ressources", k:"ECON"},
          {t:"Il propose des contenus artistiques ou visuels", k:"ESTH"},
          {t:"Vous pouvez y exercer une fonction de coordination", k:"POL"},
        ]},
      { q:"Vous devez évaluer un collaborateur. Vous vous basez sur :",
        opts:[
          {t:"Sa créativité", k:"ESTH"},
          {t:"Sa productivité", k:"ECON"},
          {t:"Sa rigueur intellectuelle", k:"COG"},
          {t:"Son comportement avec les autres", k:"SOC"},
          {t:"Son intégrité morale", k:"TRAD"},
          {t:"Son leadership naturel", k:"POL"},
        ]},
      { q:"Dans une situation de stress, vous vous apaisez en :",
        opts:[
          {t:"Écoutant de la musique ou dessinant", k:"ESTH"},
          {t:"Faisant un point financier", k:"ECON"},
          {t:"Lisant ou réfléchissant", k:"COG"},
          {t:"Méditant ou priant", k:"TRAD"},
          {t:"Parlant avec un proche", k:"SOC"},
          {t:"Prévoyant un plan d’action", k:"POL"},
        ]},
      { q:"On vous propose plusieurs formations. Vous choisissez :",
        opts:[
          {t:"Celle avec un contenu théorique fort", k:"COG"},
          {t:"Celle qui améliore votre efficacité pro", k:"ECON"},
          {t:"Celle qui développe la créativité", k:"ESTH"},
          {t:"Celle sur la communication interpersonnelle", k:"SOC"},
          {t:"Celle sur la stratégie et la gestion", k:"POL"},
          {t:"Celle sur le développement personnel ou spirituel", k:"TRAD"},
        ]},
      { q:"Pour vous, une œuvre d’art doit avant tout :",
        opts:[
          {t:"Être interprétée rationnellement", k:"COG"},
          {t:"Être un investissement rentable", k:"ECON"},
          {t:"Évoquer une émotion ou une beauté pure", k:"ESTH"},
          {t:"Inspirer ou élever l’âme", k:"TRAD"},
          {t:"Provoquer l’empathie", k:"SOC"},
          {t:"Transmettre un message politique ou social", k:"POL"},
        ]},
      { q:"Lors d’un recrutement, ce qui compte pour vous c’est :",
        opts:[
          {t:"Le niveau de connaissance du candidat", k:"COG"},
          {t:"Sa capacité à diriger", k:"POL"},
          {t:"Sa capacité à optimiser les ressources", k:"ECON"},
          {t:"Son altruisme ou son écoute", k:"SOC"},
          {t:"Son éthique et ses convictions", k:"TRAD"},
          {t:"Son sens artistique ou créatif", k:"ESTH"},
        ]},
      { q:"Dans une crise, votre premier réflexe est :",
        opts:[
          {t:"Apaiser l’ambiance par une approche sensible", k:"ESTH"},
          {t:"Comprendre les causes avec méthode", k:"COG"},
          {t:"Évaluer les pertes financières", k:"ECON"},
          {t:"Réfléchir au sens de ce qui se passe", k:"TRAD"},
          {t:"Reprendre la main sur les décisions", k:"POL"},
          {t:"Soutenir ceux qui en ont besoin", k:"SOC"},
        ]},
      { q:"Ce que vous recherchez dans un mentor, c’est :",
        opts:[
          {t:"Sa sagesse ou sa spiritualité", k:"TRAD"},
          {t:"Son autorité et sa vision", k:"POL"},
          {t:"Son empathie et sa bienveillance", k:"SOC"},
          {t:"Son expérience dans les affaires", k:"ECON"},
          {t:"Son goût du beau et du sensible", k:"ESTH"},
          {t:"Son intelligence et sa rigueur", k:"COG"},
        ]},
    ];

    // === État ===
    let idx = 0; // question actuelle
    // pour la question courante, map index opt -> rank (null|1..6)
    let currentRanks = Array(6).fill(null);
    const answers = []; // {question, mapping:[{k, rank}]}

    // === DOM
    const stepEl = document.getElementById('step');
    const barEl  = document.getElementById('bar');
    const qEl    = document.getElementById('question');
    const optsEl = document.getElementById('options');
    const nextBtn= document.getElementById('next');
    const resetBtn=document.getElementById('reset');
    const cardEl = document.getElementById('card');
    const doneEl = document.getElementById('done');

    function render(){
      const it = items[idx];
      qEl.textContent = it.q;
      stepEl.textContent = (idx+1)+" / "+items.length;
      barEl.style.width = Math.round((idx)/items.length*100)+"%";
      optsEl.innerHTML = "";

      it.opts.forEach((opt, i)=>{
        const row = document.createElement('div');
        row.className = 'opt';

        const left = document.createElement('div');
        left.textContent = opt.t;

        const right = document.createElement('div');
        right.className = 'strip';

        // pastilles 6..1
        for(let r=6;r>=1;r--){
          const dot = document.createElement('div');
          dot.className = 'dot';
          dot.textContent = r;
          dot.dataset.rank = String(r);
          dot.dataset.idx  = String(i);
          if(currentRanks[i]===r) dot.classList.add('selected');
          dot.addEventListener('click', onPickRank);
          right.appendChild(dot);
        }

        row.appendChild(left);
        row.appendChild(right);
        optsEl.appendChild(row);
      });

      validateState();
    }

    function onPickRank(e){
      const dot = e.currentTarget;
      const r = Number(dot.dataset.rank);
      const i = Number(dot.dataset.idx);

      // Libérer ce rang s'il est utilisé ailleurs
      for(let j=0;j<currentRanks.length;j++){
        if(j!==i && currentRanks[j]===r){
          currentRanks[j] = null;
        }
      }
      // Si on reclique le même rang sur la même option -> désélection ?
      if(currentRanks[i]===r){
        currentRanks[i] = null;
      }else{
        currentRanks[i] = r;
      }
      // Re-render uniquement les pastilles pour performances simples
      refreshDots();
      validateState();
    }

    function refreshDots(){
      // remet l'état selected sur chaque .dot
      const dots = optsEl.querySelectorAll('.dot');
      dots.forEach(d=>d.classList.remove('selected'));
      // pour chaque option, marquer la pastille choisie
      currentRanks.forEach((val, i)=>{
        if(val){
          const sel = optsEl.querySelector(`.dot[data-idx="${i}"][data-rank="${val}"]`);
          if(sel) sel.classList.add('selected');
        }
      });
    }

    function validateState(){
      const vals = currentRanks.filter(v=>v!==null);
      const okLen = vals.length===6;
      const uniq = new Set(vals);
      const okSet = (uniq.size===6) && [1,2,3,4,5,6].every(n=>uniq.has(n));
      nextBtn.disabled = !(okLen && okSet);
    }

    resetBtn.addEventListener('click', ()=>{
      currentRanks = Array(6).fill(null);
      refreshDots();
      validateState();
    });

    nextBtn.addEventListener('click', ()=>{
      const it = items[idx];
      const mapping = it.opts.map((opt, i)=>({ k: opt.k, rank: currentRanks[i] }));
      answers.push({ question: it.q, mapping });

      currentRanks = Array(6).fill(null);
      idx++;

      if(idx < items.length){
        render();
      }else{
        // calcul des totaux
        const totals = { TRAD:0, COG:0, ESTH:0, POL:0, ECON:0, SOC:0 };
        answers.forEach(item=>{
          item.mapping.forEach(({k,rank})=>{
            totals[k] += Number(rank||0);
          });
        });

        // stocker pour le rapport (pas d'affichage ici)
        localStorage.setItem("values_ranks", JSON.stringify(answers));
        localStorage.setItem("values_result", JSON.stringify({
          labels:[V.TRAD,V.COG,V.ESTH,V.POL,V.ECON,V.SOC],
          raw: totals
        }));

        barEl.style.width = "100%";
        cardEl.style.display = "none";
        doneEl.style.display = "block";
        window.scrollTo(0,0);
      }
    });

    // Démarrage
    render();
  </script>
</body>
</html>
